---
title: |
  | Raport z internetowego badania absolwentów, którzy ukończyli szkołę w roku 2019/2020 - II fala badania
subtitle: |
  | `r get(params$obiektWskazniki)$dane_szkoly_2f[[1]]$'nazwa szkoły'`
  | `r get(params$obiektWskazniki)$dane_szkoly_2f[[1]]$'adres szkoły'`
output:
  pdf_document:
    dev: cairo_pdf
    fig_caption: no
    includes:
      in_header: naglowek2.tex
    toc: yes
    toc_depth: 2
  html_document:
    includes:
      after_body: logo_mlezaimd_dol.html
      before_body: logo_mlezaimd_gora.html
    toc: yes
    toc_float: yes
lang: pl
papersize: a4
fontsize: 11pt
geometry: margin=20mm
params:
  obiektWskazniki: szkola
  obiektWskaznikiPorownanie: wojSzk
  plikZObiektami: ../../data/wskaznikiSzk.RData
  progLiczebnosci: 10
  typDokumentu: pdf
  wyrownanieTabWykr: center
wskazniki:
  wskazniki: szkola
  wskaznikiGrPor: wojSzk
---

```{r, echo = FALSE, message = FALSE, warning = FALSE}
library(dplyr)
library(ggplot2)
library(MLASZraporty)
library(kableExtra)
library(tidyr)

progLiczebnosci = params$progLiczebnosci
typDokumentu = params$typDokumentu
wyrownanieTabWykr = params$wyrownanieTabWykr

if (params$plikZObiektami != "") {
  obiektyZeWskaznikami = load(params$plikZObiektami)
  szkola = get(params$obiektWskazniki)
  wojSzk = get(params$obiektWskaznikiPorownanie)
} else {
  szkola = get(params$obiektWskazniki)
  wojSzk = get(params$obiektWskaznikiPorownanie)
}
wojSzk = wojSzk %>%
  filter(ID_RSPO %in% szkola$ID_RSPO)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
wyk_num = function() {
  nr = get0("___nrWykresu___", parent.frame(), ifnotfound = 1)
  assign("___nrWykresu___", nr + 1, envir = parent.frame())
  return(nr)
}
```

`r ifelse(typDokumentu %in% "pdf", "---", "")`

`r ifelse(typDokumentu %in% "pdf", "\\vfill\n\\includegraphics{Belka-Losy-absolwentow-Kolor-PL}", "")`

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

# 1. Wprowadzenie

Szanowni Państwo, przekazujemy kolejny raport z badania ankietowego przeprowadzonego w ramach projektu monitorowania losów absolwentów szkół prowadzących kształcenie w zawodach szkolnictwa branżowego. Mamy nadzieję, że przedstawione wyniki okażą się dla Państwa ciekawe i pomocne w pracy.

1.  Informacje o badaniu

    a) Badanie przeprowadzono w ramach projektu konkursowego "Monitorowanie Losów Absolwentów Szkół Zawodowych - II i III runda", realizowanego przez firmy PBS Sp. z o.o. wraz z Danae Sp. z o.o. Prace związane z przygotowaniem narzędzi badawczych i opracowaniem wyników wykonano w Instytucie Badań Edukacyjnych w ramach projektu systemowego "Monitorowanie Losów Absolwentów Szkół Zawodowych - etap II". Oba projekty są współfinansowane z funduszy Unii Europejskiej. Wsparcie pochodzi z Działania 2.15. "Kształcenie i szkolenie zawodowe dostosowane do potrzeb zmieniającej się gospodarki" II osi priorytetowej "Efektywna polityka publiczna dla rynku pracy, gospodarki i edukacji" Programu Operacyjnego Wiedza, Edukacja, Rozwój (PO WER).
    b) Raport opiera się na wynikach badania internetowego przeprowadzonego w okresie od października 2020 roku do stycznia 2021 roku. Badanie wśród absolwentów Państwa `r szkola$formy_2f[[1]]$szkola_dop` realizowała firma `r szkola$firma_badawcza_2f`
    c) Zaproszenie do wypełnienia ankiety on-line skierowano do `r szkola$liczba_ucz_1f[[1]]` absolwentów, którzy w roku 2019/2020 wzięli udział w I fali badania jako uczniowie ostatniej klasy Państwa szkoły. Raport z tego badania udostępniliśmy Państwu w październiku 2020 roku, wysyłając link z adresu: raporty@losyabsolwentow.pl.
    d) Ankietę wypełniło `r szkola$liczba_abs_2f[[1]]` absolwentów Państwa szkoły, tj. `r round(szkola$liczba_abs_2f[[1]] / szkola$liczba_ucz_1f[[1]] * 100)`% uczniów, którzy wzięli udział w I fali badania. Wyników nie należy uogólniać na pozostałych absolwentów Państwa szkoły.
    e) Osoby, które wzięły udział w badaniu w roku 2019/2020 jako uczniowie ostatnich klas Państwa szkoły, zostaną poproszone o udział w jeszcze dwóch falach badania. Wyniki kolejnych badań zostaną Państwu udostępnione w ten sam sposób co ten raport.

2.  Prezentacja wyników

    a) Wyniki prezentowane w niniejszym raporcie, dotyczące absolwentów Państwa szkoły, zestawiono z odpowiedziami absolwentów innych `r szkola$formy_2f[[1]]$szkola_lmn` z województwa `r szkola$formy_2f[[1]]$woj_nazwa_dop` z tego samego rocznika. Pozwala to umieścić wyniki uzyskane w Państwa szkole w szerszym kontekście. Niemniej, biorąc pod uwagę specyfikę poszczególnych szkół oraz zróżnicowany poziom realizacji badania (wzięła w nim udział tylko część absolwentów poproszonych o wypełnienie ankiety), do zaobserwowanych różnic należy podchodzić z dużą ostrożnością.
    b) Minimalna liczebność grupy uczestniczących w badaniu absolwentów Państwa szkoły, dla której przedstawiane są poszczególne wyniki w raporcie, wynosi 10 osób. Jeżeli wśród absolwentów szkoły nie udało się uzyskać odpowiedzi na pytanie od minimum 10 respondentów, wynik nie jest prezentowany.
    c) W celu zachowania czytelności wykresów, etykiety z wartościami poniżej 6% nie są prezentowane.
    d) W celu skorygowania wpływu poziomu realizacji badań w różnych lokalizacjach na wyniki badania, dane zostały odpowiednio przeważone.
    e) Niesumowanie się wartości na niektórych wykresach do 100% lub sumowanie się do wartości innej, niż podana w tekście, wynika z zaokrągleń.
    f) Ze względu na dużą liczbę raportów (w badaniu wzięli udział absolwenci 1711 szkół), zostały one sporządzone automatycznie.

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

3.  Absolwenci, których dotyczy raport

    a) Osoby, które w roku 2019/2020 wzięły udział w badaniu jako uczniowie ostatnich klas `r szkola$formy_2f[[1]]$szkola_lmn`, a następnie jako absolwenci w badaniu realizowanym od października 2020 roku do stycznia 2021 roku.
    b) Liczba absolwentów Państwa szkoły, których dotyczy raport: `r szkola$liczba_abs_2f[[1]]`, w tym kobiet: `r szkola$liczba_kobiet_2f[[1]]`.
    c) Zawody, w których kształcili się respondenci w Państwa szkole:

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$liczba_abs_2f[[1]] >= progLiczebnosci) {
  as.data.frame(szkola$zawod_liczebnosc_2f[[1]]) %>% 
    select(-c(n, branza)) %>% 
    arrange(desc(n_zaw)) %>%
    mutate(across(zawod, ~ linebreak(., align = c("l")))) %>%
    rename(`Zawód` = zawod,
           `Liczba respondentów` = n_zaw) %>% 
    kable("latex", booktabs = TRUE, escape = FALSE, longtable = TRUE,
          linesep = "",
          align = "lc",
          format.args = list(decimal.mark = ",", big.mark = " "),
          col.names = linebreak(c("Zawód", "Liczba\nrespondentów"), align = c("l", "l"))) %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = c("hold_position", "repeat_header"),
                  repeat_header_text = "ciąg dalszy")
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

# 2. Sytuacja zawodowa absolwentów w okresie lipiec-wrzesień 2020

## 2.1. Praca zarobkowa

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$praca_zarobkowa_2f[[1]]$n >= progLiczebnosci) {
  cat(
    "Wśród uczestników badania, którzy zakończyli naukę w Państwa szkole, ",
    round(szkola$praca_zarobkowa_2f[[1]]$ods_prac_zar_ever * 100),
    "% pracowało zarobkowo przez co najmniej dwa tygodnie w lipcu, sierpniu lub we wrześniu 2020 roku. W przypadku pozostałych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    " co najmniej dwutygodniowy okres pracy w ciągu jednego z tych miesięcy charakteryzował ",
    round(wojSzk$praca_zarobkowa_2f_waga[[1]]$ods_prac_zar_ever * 100),
    "% absolwentów.\n\n",
    "\\textcolor{gray}{Uwzględniono epizody pracy zarobkowej trwające co najmniej dwa tygodnie w danym miesiącu. Do porównań wybrano okres od lipca do września 2020 roku, ponieważ dla tych miesięcy zostały uzyskane informacje o sytuacji zawodowej od wszystkich absolwentów uczestniczących w badaniu (pierwsze ankiety zrealizowano w październiku, a respondenci odnosili się do miesięcy poprzedzających miesiąc, w którym wypełniali ankietę).}\n\n",
    "Na poszczególnych wykresach dane dotyczące absolwentów Państwa szkoły są zestawiane z danymi absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ", którzy również zostali objęci badaniem.",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$praca_zarobkowa_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$praca_zarobkowa_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    rename(rozklad = ods_prac_zar_ever) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = as.data.frame(wojSzk$praca_zarobkowa_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    rename(rozklad = ods_prac_zar_ever) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów, którzy w okresie od lipca do września 2020\nroku mieli epizod pracy zarobkowej"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot", # żeby tytuł był najbardziej po lewej
          plot.title = element_text(size = 12)) + 
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$praca_zarobkowa_2f[[1]]$n >= progLiczebnosci) {
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$praca_zarobkowa_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$praca_zarobkowa_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie \"Proszę spojrzeć na poniższy kalendarz i zaznaczyć miesiące, w których w sumie przez co najmniej dwa tygodnie (bez względu na liczbę godzin w tygodniu): (...) pracował(a) Pan(i). zarobkowo?\". Respondenci, w odniesieniu do każdego miesiąca, wskazywali odpowiedź \"Tak\" lub \"Nie\".}",
    sep = ""
  )
}
```

```{r, echo = FALSE, fig.align = wyrownanieTabWykr, results = 'asis'}
if (szkola$liczba_abs_2f[[1]] >= progLiczebnosci) {
  cat("Odsetek absolwentów Państwa szkoły wykonujących pracę zarobkową przez co najmniej dwa tygodnie ", sep = "")
  if ((szkola$praca_zarobkowa_mies_2f[[1]]$ods_prac_zar_07 != szkola$praca_zarobkowa_mies_2f[[1]]$ods_prac_zar_08) &
       (szkola$praca_zarobkowa_mies_2f[[1]]$ods_prac_zar_08 != szkola$praca_zarobkowa_mies_2f[[1]]$ods_prac_zar_09) &
       (szkola$praca_zarobkowa_mies_2f[[1]]$ods_prac_zar_07 != szkola$praca_zarobkowa_mies_2f[[1]]$ods_prac_zar_09)) {
    cat(
      "różnił się w zależności od miesiąca i wynosił ",
      round(szkola$praca_zarobkowa_mies_2f[[1]]$ods_prac_zar_07 * 100),
      "% w lipcu, ",
      round(szkola$praca_zarobkowa_mies_2f[[1]]$ods_prac_zar_08 * 100),
      "% w sierpniu i ",
      round(szkola$praca_zarobkowa_mies_2f[[1]]$ods_prac_zar_09 * 100),
      "% we wrześniu.\n\n",
      sep = ""
    )
  } else {
    cat(
      "nie różnił się w zależności od miesiąca.\n\n"
    )
  }
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$praca_zarobkowa_mies_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$praca_zarobkowa_mies_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Państwa szkoła",
           name = c("2020.07", "2020.08", "2020.09"))
  tab2 = as.data.frame(wojSzk$praca_zarobkowa_mies_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("2020.07", "2020.08", "2020.09"))
  
  tab = rbind(tab1, tab2)
  
  wykres = ggplot(tab, aes(x = name, y = value, colour = typ, group = typ)) +
    geom_point(aes(shape = typ, color = typ), size = 2) +
    geom_line(aes(linetype = typ, color = typ), size = 1) +
    ylab(NULL) + 
    xlab("Miesiąc") +
    labs(title = paste0(
      "Wykres ", wyk_num(),
      ": Odsetek absolwentów, którzy w danym miesiącu mieli epizod pracy\nzarobkowej"),
      fill = NULL) +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 1),
                       breaks = seq(0, 1,by = 0.2)) +
    theme(legend.title = element_blank(),
          plot.title = element_text(size = 12),
          panel.background = element_rect(fill = "white"),
          panel.grid.major = element_line(color = "lightgray"),
          plot.title.position = "plot") +
    geom_rect(xmin = 0.5, xmax = 3.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    scale_shape_manual(values = c(1, 0)) +
    scale_linetype_manual(values = c(1, 2))
  
  print(wykres)
  
  cat("Dane z wykresu przedstawiono szczegółowo w poniższej tabeli.\n\n")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1)) 
}
```

## 2.2. Bezrobocie rejestrowane

```{r, echo = FALSE, fig.align = wyrownanieTabWykr, results = 'asis'}
if (szkola$bezrobocie_2f[[1]]$n >= progLiczebnosci) {
  cat(
    "W okresie od lipca do września 2020 roku ",
    round(szkola$bezrobocie_2f[[1]]$bezrob_ever * 100),
    "% absolwentów Państwa szkoły uczestniczących w badaniu zarejestrowało się w urzędzie pracy jako osoby bezrobotne. Spośród absolwentów pozostałych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    " co najmniej dwutygodniowy okres bezrobocia rejestrowanego w lipcu, sierpniu lub we wrześniu 2020 roku odnotowano ",
    if (round(szkola$bezrobocie_2f[[1]]$bezrob_ever * 100) == round(wojSzk$bezrobocie_2f_waga[[1]]$bezrob_ever * 100)) {paste0("również")},
    " w przypadku ",
    round(wojSzk$bezrobocie_2f_waga[[1]]$bezrob_ever * 100),
    "%.\n\n",
    "\\textcolor{gray}{Uwzględniono epizody bezrobocia rejestrowanego trwające co najmniej dwa tygodnie w danym miesiącu.}",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$bezrobocie_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$bezrobocie_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    rename(rozklad = bezrob_ever) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = as.data.frame(wojSzk$bezrobocie_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    rename(rozklad = bezrob_ever) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów, którzy w okresie od lipca do września 2020\nroku mieli epizod bezrobocia rejestrowanego"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
}
```

```{r, echo = FALSE, fig.align = wyrownanieTabWykr, results = 'asis'}
if (szkola$bezrobocie_2f[[1]]$n >= progLiczebnosci) {
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$bezrobocie_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$bezrobocie_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie \"Proszę spojrzeć na poniższy kalendarz i zaznaczyć miesiące, w których w sumie przez co najmniej dwa tygodnie (bez względu na liczbę godzin w tygodniu): (...) był(a) Pan(i) zarejestrowany(a) w urzędzie pracy jako osoba bezrobotna?\". Respondenci, w odniesieniu do każdego miesiąca, wskazywali odpowiedź \"Tak\" lub \"Nie\".}",
    sep = ""
  )
}
```

```{r, echo = FALSE, fig.align = wyrownanieTabWykr, results = 'asis'}
if (szkola$bezrobocie_mies_2f[[1]]$n >= progLiczebnosci) {
  if (any(round(szkola$bezrobocie_mies_2f[[1]]$bezrob_07 * 100) != round(szkola$bezrobocie_mies_2f[[1]]$bezrob_08 * 100),
          round(szkola$bezrobocie_mies_2f[[1]]$bezrob_08 * 100) != round(szkola$bezrobocie_mies_2f[[1]]$bezrob_09 * 100),
          round(szkola$bezrobocie_mies_2f[[1]]$bezrob_07 * 100) != round(szkola$bezrobocie_mies_2f[[1]]$bezrob_09 * 100))) {
    cat(
      "W lipcu osoby zarejestrowane jako bezrobotne stanowiły ",
      round(szkola$bezrobocie_mies_2f[[1]]$bezrob_07 * 100),
      "% absolwentów Państwa szkoły, w sierpniu ",
      round(szkola$bezrobocie_mies_2f[[1]]$bezrob_08 * 100),
      "%, we wrześniu ",
      round(szkola$bezrobocie_mies_2f[[1]]$bezrob_09 * 100),
      "%.",
      sep = ""
    )
  } else {
    cat(
      "W ciągu każdego z trzech rozpatrywanych miesięcy osoby zarejestrowane jako bezrobotne stanowiły ",
      round(szkola$bezrobocie_mies_2f[[1]]$bezrob_07 * 100),
      "% absolwentów Państwa szkoły.",
      sep = ""
    )
  }
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$bezrobocie_mies_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$bezrobocie_mies_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Państwa szkoła",
           name = c("2020.07", "2020.08", "2020.09"))
  tab2 = as.data.frame(wojSzk$bezrobocie_mies_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("2020.07", "2020.08", "2020.09"))
  
  tab = rbind(tab1, tab2)
  
  wykres = ggplot(tab, aes(x = name, y = value, colour = typ, group = typ)) +
    geom_point(aes(shape = typ, color = typ), size = 2) +
    geom_line(aes(linetype = typ, color = typ), size = 1) +
    ylab(NULL) + 
    xlab("Miesiąc") +
    labs(title = paste0(
      "Wykres ", wyk_num(),
      ": Odsetek absolwentów, którzy w danym miesiącu mieli epizod bezrobocia\nrejestrowanego"),
      fill = NULL) +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 1),
                       breaks = seq(0, 1,by = 0.2)) +
    theme(legend.title = element_blank(),
          plot.title = element_text(size = 12),
          panel.background = element_rect(fill = "white"),
          panel.grid.major = element_line(color = "lightgray"),
          plot.title.position = "plot") +
    geom_rect(xmin = 0.5, xmax = 3.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    scale_shape_manual(values = c(1, 0)) +
    scale_linetype_manual(values = c(1, 2))
  
  print(wykres)
  
  cat("Dane z wykresu przedstawiono szczegółowo w poniższej tabeli.\n\n")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
}
```

## 2.3. Bierność edukacyjna i zawodowa (NEET)

```{r, echo = FALSE, fig.align = wyrownanieTabWykr, results = 'asis'}
if (szkola$neet_2f[[1]]$n >= progLiczebnosci) {
  if (szkola$neet_2f[[1]]$neet_ever %in% 0) {
    cat(
      "Wśród uczestniczących w badaniu absolwentów Państwa szkoły żaden nie był bierny edukacyjnie i zawodowo przez cały okres od lipca do września 2020 roku.",
      sep = ""
    )
  } else {
    cat(
      "Wśród uczestniczących w badaniu absolwentów Państwa szkoły ",
      round(szkola$neet_2f[[1]]$neet_ever * 100),
      "% pozostawało biernych edukacyjnie i zawodowo przez cały okres od lipca do września 2020 roku. Do tej grupy mogły należeć m.in. osoby, które później, tj. od października, podjęły dalszą naukę - informacje na temat kontynuowania nauki przedstawiamy  w kolejnym rozdziale.",
      sep = ""
    )
  }
  cat(
    "\n\n\\textcolor{gray}{Bierność edukacyjna i zawodowa jest tutaj rozumiana jako brak w danym miesiącu co najmniej dwutygodniowego epizodu nauki, wykonywania lub poszukiwania pracy zarobkowej oraz odbywania bezpłatnych praktyk, stażu lub wolontariatu. Bierność edukacyjna i zawodowa jest tożsama pojęciu NEET (ang. Neither in Employment nor in Education and Training).}",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$neet_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$neet_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    rename(rozklad = neet_ever) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = as.data.frame(wojSzk$neet_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    rename(rozklad = neet_ever) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów, którzy przez cały okres\nod lipca do września 2020 roku pozostawali bierni edukacyjnie i zawodowo"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
}
```

```{r, echo = FALSE, fig.align = wyrownanieTabWykr, results = 'asis'}
if (szkola$neet_2f[[1]]$n >= progLiczebnosci) {
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$neet_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$bezrobocie_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytania \"Proszę spojrzeć na poniższy kalendarz i zaznaczyć miesiące, w których w sumie przez co najmniej dwa tygodnie (bez względu na liczbę godzin w tygodniu): uczył(a) się Pan(i) w szkole, na kursie lub na studiach?; pracował(a) Pan(i) zarobkowo?; odbywała(a) Pan(i) bezpłatne praktyki, staż lub wolontariat?; poszukiwał(a) Pan(i) pracy zarobkowej?\". Respondenci, w odniesieniu do każdego pytania i miesiąca, wskazywali odpowiedź \"Tak\" lub \"Nie\".}\n\n",
    sep = ""
  )
  if ((szkola$neet_mies_2f[[1]]$neet_07 > szkola$neet_mies_2f[[1]]$neet_08) & (szkola$neet_mies_2f[[1]]$neet_07 > szkola$neet_mies_2f[[1]]$neet_09) | 
      (szkola$neet_mies_2f[[1]]$neet_08 > szkola$neet_mies_2f[[1]]$neet_09) & (szkola$neet_mies_2f[[1]]$neet_08 > szkola$neet_mies_2f[[1]]$neet_07) |
      (szkola$neet_mies_2f[[1]]$neet_09 > szkola$neet_mies_2f[[1]]$neet_07) & (szkola$neet_mies_2f[[1]]$neet_09 > szkola$neet_mies_2f[[1]]$neet_08)) {
    
    mies_max = case_when((
      szkola$neet_mies_2f[[1]]$neet_07 > szkola$neet_mies_2f[[1]]$neet_08) & (szkola$neet_mies_2f[[1]]$neet_07 > szkola$neet_mies_2f[[1]]$neet_09) ~ "w lipcu",
      (szkola$neet_mies_2f[[1]]$neet_08 > szkola$neet_mies_2f[[1]]$neet_09) & (szkola$neet_mies_2f[[1]]$neet_08 > szkola$neet_mies_2f[[1]]$neet_07) ~ "w sierpniu",
      (szkola$neet_mies_2f[[1]]$neet_09 > szkola$neet_mies_2f[[1]]$neet_07) & (szkola$neet_mies_2f[[1]]$neet_09 > szkola$neet_mies_2f[[1]]$neet_08) ~ "we wrześniu")
    
    mies_wart = case_when(
      mies_max %in% "w lipcu" ~ szkola$neet_mies_2f[[1]]$neet_07,
      mies_max %in% "w sierpniu" ~ szkola$neet_mies_2f[[1]]$neet_08,
      mies_max %in% "we wrześniu" ~ szkola$neet_mies_2f[[1]]$neet_09)
    
    cat(
      "Odsetek biernych edukacyjnie i zawodowo absolwentów Państwa szkoły w ciągu rozpatrywanego okresu był najwyższy ",
      mies_max,
      " - wynosił wówczas ",
      round(mies_wart * 100),
      "%.",
      sep = ""
    )
    
  } else if ((szkola$neet_mies_2f[[1]]$neet_07 < szkola$neet_mies_2f[[1]]$neet_08) & (szkola$neet_mies_2f[[1]]$neet_07 < szkola$neet_mies_2f[[1]]$neet_09) | 
             (szkola$neet_mies_2f[[1]]$neet_08 < szkola$neet_mies_2f[[1]]$neet_09) & (szkola$neet_mies_2f[[1]]$neet_08 < szkola$neet_mies_2f[[1]]$neet_07) |
             (szkola$neet_mies_2f[[1]]$neet_09 < szkola$neet_mies_2f[[1]]$neet_07) & (szkola$neet_mies_2f[[1]]$neet_09 < szkola$neet_mies_2f[[1]]$neet_08)) {
    
    mies_min = case_when((
      szkola$neet_mies_2f[[1]]$neet_07 < szkola$neet_mies_2f[[1]]$neet_08) & (szkola$neet_mies_2f[[1]]$neet_07 < szkola$neet_mies_2f[[1]]$neet_09) ~ "w lipcu",
      (szkola$neet_mies_2f[[1]]$neet_08 < szkola$neet_mies_2f[[1]]$neet_09) & (szkola$neet_mies_2f[[1]]$neet_08 < szkola$neet_mies_2f[[1]]$neet_07) ~ "w sierpniu",
      (szkola$neet_mies_2f[[1]]$neet_09 < szkola$neet_mies_2f[[1]]$neet_07) & (szkola$neet_mies_2f[[1]]$neet_09 < szkola$neet_mies_2f[[1]]$neet_08) ~ "we wrześniu")
    
    mies_wart = case_when(
      mies_min %in% "w lipcu" ~ szkola$neet_mies_2f[[1]]$neet_07,
      mies_min %in% "w sierpniu" ~ szkola$neet_mies_2f[[1]]$neet_08,
      mies_min %in% "we wrześniu" ~ szkola$neet_mies_2f[[1]]$neet_09)
    
    cat(
      "Odsetek biernych zawodowo absolwentów Państwa szkoły w ciągu rozpatrywanego okresu był najniższy ",
      mies_min,
      " - wynosił wówczas ",
      round(mies_wart * 100),
      "%.",
      sep = ""
    )
  } else if ((szkola$neet_mies_2f[[1]]$neet_07 == szkola$neet_mies_2f[[1]]$neet_08) & (szkola$neet_mies_2f[[1]]$neet_07 == szkola$neet_mies_2f[[1]]$neet_09) & (szkola$neet_mies_2f[[1]]$neet_08 == szkola$neet_mies_2f[[1]]$neet_09)) {
    
    cat("Odsetek biernych zawodowo absolwentów Państwa szkoły nie różnił się w zależności od miesiąca.")
  }
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$neet_mies_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$neet_mies_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Państwa szkoła",
           name = c("2020.07", "2020.08", "2020.09"))
  tab2 = as.data.frame(wojSzk$neet_mies_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = paste0(round(value * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("2020.07", "2020.08", "2020.09"))
  
  tab = rbind(tab1, tab2)
  
  wykres = ggplot(tab, aes(x = name, y = value, colour = typ, group = typ)) +
    geom_point(aes(shape = typ, color = typ), size = 2) +
    geom_line(aes(linetype = typ, color = typ), size = 1) +
    ylab(NULL) + 
    xlab("Miesiąc") +
    labs(title = paste0(
      "Wykres ", wyk_num(),
      ": Odsetek absolwentów, którzy w danym miesiącu pozostawali bierni\nedukacyjnie i zawodowo"),
      fill = NULL) +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 1),
                       breaks = seq(0, 1,by = 0.2)) +
    theme(legend.title = element_blank(),
          plot.title = element_text(size = 12),
          panel.background = element_rect(fill = "white"),
          panel.grid.major = element_line(color = "lightgray"),
          plot.title.position = "plot") +
    geom_rect(xmin = 0.5, xmax = 3.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25) +
    scale_shape_manual(values = c(1, 0)) +
    scale_linetype_manual(values = c(1, 2))
  
  print(wykres)
  
  cat("Dane z wykresu przedstawiono szczegółowo w poniższej tabeli.\n\n")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
}
```

## 2.4. Sytuacja edukacyjno-zawodowa absolwentów w październiku 2020

```{r, echo = FALSE, fig.align = wyrownanieTabWykr, results = 'asis'}
if (szkola$status_2020_10[[1]]$n >= progLiczebnosci) {
  cat(
    "W październiku 2020 roku ",
    round(szkola$status_2020_10[[1]]$nauka_praca * 100),
    "% objętych badaniem absolwentów Państwa szkoły poświęciło po co najmniej dwa tygodnie zarówno na pracę zarobkową, jak i na dalszą naukę. Z kolei ",
    round(szkola$status_2020_10[[1]]$tylko_praca * 100),
    "% pracowało zarobkowo nie kontynuując nauki, a ",
    round(szkola$status_2020_10[[1]]$tylko_nauka * 100),
    "% uczestniczyło w edukacji, ale nie pracowało. Ani dwutygodniowego okresu pracy zarobkowej, ani takiego okresu nauki, nie miało w październiku ",
    round(szkola$status_2020_10[[1]]$brak_nauka_brak_praca * 100),
    "%.\n\n",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$status_2020_10[[1]]$n >= progLiczebnosci) {
  if (szkola$TYP %in% 1) {
    cat(
      "\\textcolor{gray}{Dla absolwentów wszystkich szkół rozpatrywano sytuację w październiku 2020 roku."
    )
  } else {
    cat(
      "\\textcolor{gray}{Dla absolwentów wszystkich szkół rozpatrywano sytuację w październiku 2020 roku, żeby uwzględnić ewentualne rozpoczynanie nauki na studiach po ukończeniu techników i szkół policealnych."
    )
  }
  
  if (szkola$status_2020_10[[1]]$nie_dotyczy_liczba != 0 & wojSzk$status_2020_10_waga[[1]]$nie_dotyczy_liczba %in% 0) {
    cat(
      " Jednak ponieważ część absolwentów wypełniła ankiety w październiku (a respondenci odnosili się do miesięcy poprzedzających miesiąc, w którym wypełniali ankietę), liczba respondentów, na których odpowiedziach opierają się wyniki dotyczące Państwa szkoły jest mniejsza, niż w przypadku wyników prezentowanych we wcześniejszej części raportu.}\n\n"
    )
  } else if (szkola$status_2020_10[[1]]$nie_dotyczy_liczba %in% 0 & wojSzk$status_2020_10_waga[[1]]$nie_dotyczy_liczba != 0) {
    cat(
      " Jednak ponieważ część absolwentów wypełniła ankiety w październiku (a respondenci odnosili się do miesięcy poprzedzających miesiąc, w którym wypełniali ankietę), liczba respondentów, na których odpowiedziach opierają się wyniki dotyczące innych ",
      szkola$formy_2f[[1]]$szkola_lmn,
      " z województwa ",
      szkola$formy_2f[[1]]$woj_nazwa_dop,
      " jest mniejsza, niż w przypadku wyników prezentowanych we wcześniejszej części raportu.}\n\n",
      sep = ""
    )
  } else if (szkola$status_2020_10[[1]]$nie_dotyczy_liczba != 0 & wojSzk$status_2020_10_waga[[1]]$nie_dotyczy_liczba != 0) {
    cat(
      " Jednak ponieważ część absolwentów wypełniła ankiety w październiku (a respondenci odnosili się do miesięcy poprzedzających miesiąc, w którym wypełniali ankietę), liczba respondentów, na których odpowiedziach opierają się wyniki dotyczące Państwa szkoły oraz innych ",
      szkola$formy_2f[[1]]$szkola_lmn,
      " z województwa ",
      szkola$formy_2f[[1]]$woj_nazwa_dop,
      " jest mniejsza, niż w przypadku wyników prezentowanych we wcześniejszej części raportu.}\n\n",
      sep = ""
    )
  } else if (szkola$status_2020_10[[1]]$nie_dotyczy_liczba %in% 0 & wojSzk$status_2020_10_waga[[1]]$nie_dotyczy_liczba %in% 0) {
    cat( 
      "}\n\n"
    )
  }
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$status_2020_10[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$status_2020_10[[1]]) %>% 
    select(-c(n, etykieta, nie_dotyczy_liczba)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Tylko pracowali",
                    "Tylko się uczyli",
                    "Uczyli się i pracowali",
                    "Nie uczyli się ani nie pracowali"))
  tab2 = as.data.frame(wojSzk$status_2020_10_waga[[1]]) %>% 
    select(-c(n, etykieta, nie_dotyczy_liczba)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Tylko pracowali",
                    "Tylko się uczyli",
                    "Uczyli się i pracowali",
                    "Nie uczyli się ani nie pracowali"))
  
  tab = rbind(tab1, tab2)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#fa9fb5", "#f44b8f", "#b20174", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Sytuacja edukacyjno-zawodowa absolwentów w październiku 2020\nroku"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
}
```

```{r, echo = FALSE, fig.align = wyrownanieTabWykr, results = 'asis'}
if (szkola$status_2020_10[[1]]$n >= progLiczebnosci) {
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia rozkład zmiennej utworzonej na podstawie pytań: \"Proszę spojrzeć na poniższy kalendarz i zaznaczyć miesiące, w których w sumie przez co najmniej dwa tygodnie (bez względu na liczbę godzin w tygodniu): (...) uczył(a) się Pan(i) w szkole, na kursie lub na studiach?; pracował(a) Pan(i) zarobkowo?\". Respondenci, w odniesieniu do każdego miesiąca, wskazywali odpowiedź \"Tak\" lub \"Nie\". Wykres uwzględnia odpowiedzi dotyczące października, udzielone przez ",
    szkola$status_2020_10[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$status_2020_10_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lm,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ".}\n\n",
    "Dane z wykresu przedstawiono szczegółowo w poniższej tabeli.\n\n",
    sep = ""
  )
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$status_2020_10[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$status_2020_10[[1]]) %>% 
    select(-c(n, etykieta, nie_dotyczy_liczba)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Tylko pracowali",
                    "Tylko się uczyli",
                    "Uczyli się i pracowali",
                    "Nie uczyli się ani nie pracowali"))
  tab2 = as.data.frame(wojSzk$status_2020_10_waga[[1]]) %>% 
    select(-c(n, etykieta, nie_dotyczy_liczba)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Tylko pracowali",
                    "Tylko się uczyli",
                    "Uczyli się i pracowali",
                    "Nie uczyli się ani nie pracowali"))
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    arrange(desc(name)) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c("Absolwenci którzy:", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
}
```

## 2.5. Ścieżki kontynuowania edukacji

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$TYP %in% 3) {
  if (szkola$kontyn_eduk_2f[[1]]$n_tech_spolic >= progLiczebnosci) {
    cat(
      "Pomiędzy lipcem 2020 roku a momentem wypełnienia ankiety (badanie było realizowane w okresie od października 2020 do stycznia 2021 roku), spośród absolwentów Państwa szkoły, naukę na kwalifikacyjnym kursie zawodowym rozpoczęło ",
      round(szkola$kontyn_eduk_2f[[1]]$kkz * 100),
      "%.\n\n",
      sep = ""
    )
    
    tab1 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = kkz) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab2 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = kkz) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab1_2 = rbind(tab1, tab2)
    
    wykres1 = ggplot(tab1_2, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu szkoły policealnej\nrozpoczęli naukę na kwalifikacyjnym kursie zawodowym"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab1_2$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres1)
    
    cat(
      "\n\n\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
      szkola$kontyn_eduk_2f[[1]]$n_tech_spolic,
      " absolwentów Państwa szkoły oraz ",
      round(wojSzk$kontyn_eduk_2f_waga[[1]]$n_tech_spolic),
      " absolwentów innych ",
      szkola$formy_2f[[1]]$szkola_lmn,
      " z województwa ",
      szkola$formy_2f[[1]]$woj_nazwa_dop,
      ". Respondentom zadano pytanie “Czy po zakończeniu nauki w (...) szkole policealnej uczestniczył(a) Pan(i) w rekrutacji: (...) do szkoły policealnej?”. Respondenci wskazywali odpowiedź “Tak i rozpocząłem(a) tam naukę”, “Tak, ale nie rozpocząłem(am) tam nauki” lub “Nie”.}\n\n",
      sep = ""
    )
    
    # tabela1_2 = tab1 %>% 
    #   left_join(tab2, by = "name") %>% 
    #   select(-contains(c("typ", "lab"))) %>% 
    #   mutate(xx = paste0(round(value.x * 100), "%"),
    #          yy = paste0(round(value.y * 100), "%")) %>% 
    #   select(-contains("value")) %>% 
    #   arrange(desc(name)) %>% 
    #   kable("latex", booktabs = TRUE,
    #         col.names = NULL, linesep = "",
    #         align = "lcc") %>%
    #   kable_styling(position = wyrownanieTabWykr,
    #                 latex_options = "hold_position") %>% 
    #   add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
    # 
    # print(tabela1_2)
    
    cat("Studentami zostało  ",
      round(szkola$kontyn_eduk_2f[[1]]$studia * 100),
      "% absolwentów Państwa szkoły, z którymi przeprowadzono badanie.\n\n",
      sep = ""
    )
    
    # Wykres studia
    tab3 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = studia) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab4 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = studia) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab3_4 = rbind(tab3, tab4)
    
    wykres2 = ggplot(tab3_4, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu szkoły policealnej\nkontynuowali naukę na studiach wyższych"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab3_4$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres2)
    
  } else {
    cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
  }
}
```

<!-- ROZDZIAŁ TYLKO DLA SZKÓŁ BRANŻOWYCH -->

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$TYP %in% 1) {
  if (szkola$kontyn_eduk_2f[[1]]$n_bs1 >= progLiczebnosci) {
    cat(
      "Pomiędzy lipcem 2020 roku a momentem wypełnienia ankiety (badanie było realizowane w okresie od października 2020 do stycznia 2021 roku), spośród absolwentów Państwa szkoły naukę w szkole branżowej drugiego stopnia, w liceum dla dorosłych lub na kwalifikacyjnym kursie zawodowym rozpoczęło ",
      round(szkola$kontyn_eduk_2f[[1]]$dowolna_forma * 100),
      "%.\n\n",
      sep = ""
    )
    
    # Wykres dowolna forma
    tab1 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = dowolna_forma) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab2 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = dowolna_forma) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab1_2 = rbind(tab1, tab2)
    
    wykres1 = ggplot(tab1_2, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu szkoły branżowej\npierwszego stopnia kontynuowali naukę w dowolnej formie"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab1_2$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres1)
    
    cat(
      "\n\n\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
      szkola$kontyn_eduk_2f[[1]]$n_bs1,
      " absolwentów Państwa szkoły oraz ",
      round(wojSzk$kontyn_eduk_2f_waga[[1]]$n_bs1 * 1),
      " absolwentów innych szkół branżowych pierwszego stopnia z województwa ",
      szkola$formy_2f[[1]]$woj_nazwa_dop,
      ". Respondentom zadano pytania “Czy po zakończeniu nauki w szkole branżowej uczestniczył(a) Pan(i) w rekrutacji: (...) do szkoły branżowej drugiego stopnia?; liceum dla dorosłych?; na kwalifikacyjny kurs zawodowy?”. Respondenci wskazywali odpowiedź “Tak i rozpocząłem(a) tam naukę”, “Tak, ale nie rozpocząłem(am) tam nauki” lub “Nie”. Wykres uwzględnia pierwszą z tych odpowiedzi.}\n\n",
      "W szkole branżowej drugiego stopnia podjęło dalszą naukę ",
      round(szkola$kontyn_eduk_2f[[1]]$bs2 * 100),
      "% absolwentów Państwa szkoły, z którymi zostało przeprowadzone badanie.\n\n",
      sep = ""
    )
    
    # Wykres branżowa szkoła 2. stopnia
    tab3 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = bs2) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab4 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = bs2) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab3_4 = rbind(tab3, tab4)
    
    wykres2 = ggplot(tab3_4, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu szkoły branżowej\nI stopnia  kontynuowali naukę w szkole branżowej II stopnia"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab3_4$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres2)
    
    # wykres liceum dla dorosłych
    cat(
      "\n\nW liceum dla dorosłych kontynuowało naukę ",
      round(szkola$kontyn_eduk_2f[[1]]$lic_dor * 100),
      "% absolwentów Państwa szkoły objętych badaniem.\n\n",
      sep = ""
    )
    
    tab5 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = lic_dor) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab6 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = lic_dor) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab5_6 = rbind(tab5, tab6)
    
    wykres3 = ggplot(tab5_6, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu szkoły branżowej\nI stopnia kontynuowali naukę w liceum dla dorosłych"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab5_6$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres3)
    
    # wykres Kwalifikacyjne Kursy Zawodowe
    cat(
      "Kwalifikacyjne kursy zawodowe okazały się formą kontynuowania nauki wybraną przez ",
      round(szkola$kontyn_eduk_2f[[1]]$kkz * 100),
      "% absolwentów Państwa szkoły, którzy wypełnili ankiety.\n\n",
      sep = ""
    )
    
    tab7 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = kkz) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab8 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = kkz) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab7_8 = rbind(tab7, tab8)
    
    wykres4 = ggplot(tab7_8, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu szkoły branżowej\npierwszego stopnia kontynuowali naukę na Kwalifikacyjnym\nKursie Zawodowym"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab7_8$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres4)
  } else {
    cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
  }
}
```

<!-- ROZDZIAŁ TYLKO DLA TECHNIKÓW -->

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr, warning = FALSE}
if (szkola$TYP %in% 2) {
  if (szkola$kontyn_eduk_2f[[1]]$n_tech_spolic >= progLiczebnosci) {
    cat(
      "Pomiędzy lipcem 2020 roku a momentem wypełnienia ankiety (badanie było realizowane w okresie od października 2020 do stycznia 2021 roku), spośród absolwentów Państwa szkoły naukę w szkole policealnej, na studiach lub na kwalifikacyjnym kursie zawodowym rozpoczęło ",
      round(szkola$kontyn_eduk_2f[[1]]$dowolna_forma * 100),
      "%.\n\n",
      sep = ""
    )
    
    # Wykres dowolna forma
    tab1 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = dowolna_forma) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab2 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = dowolna_forma) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab1_2 = rbind(tab1, tab2)
    
    wykres1 = ggplot(tab1_2, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu technikum\nkontynuowali naukę w dowolnej formie"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab1_2$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres1)
    
    cat(
      "\n\n\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
      szkola$kontyn_eduk_2f[[1]]$n_tech_spolic,
      " absolwentów Państwa szkoły oraz ",
      round(wojSzk$kontyn_eduk_2f_waga[[1]]$n_tech_spolic),
      " absolwentów innych  szkół branżowych pierwszego stopnia z województwa ",
      szkola$formy_2f[[1]]$woj_nazwa_dop,
      ". Respondentom zadano pytanie “Czy po zakończeniu nauki w technikum] uczestniczył(a) Pan(i) w rekrutacji: (...) do szkoły policealnej?; do szkoły wyższej (na studia)?; na kwalifikacyjny kurs zawodowy?”. Respondenci wskazywali odpowiedź “Tak i rozpocząłem(a) tam naukę”, “Tak, ale nie rozpocząłem(am) tam nauki” lub “Nie”. Wykres uwzględnia pierwszą z tych odpowiedzi.}\n\n",
      "Studentami zostało  ",
      round(szkola$kontyn_eduk_2f[[1]]$studia * 100),
      "% absolwentów Państwa szkoły, z którymi przeprowadzono badanie.\n\n",
      sep = ""
    )
    
    # Wykres studia
    tab3 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = studia) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab4 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = studia) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab3_4 = rbind(tab3, tab4)
    
    wykres2 = ggplot(tab3_4, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu technikum\nkontynuowali naukę na studiach wyższych"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab3_4$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres2)
    
    # wykres szkoła policealna
    cat(
      "\n\nW szkole policealnej podjęło dalszą naukę ",
      round(szkola$kontyn_eduk_2f[[1]]$spolic * 100),
      "% absolwentów Państwa szkoły objętych badaniem.\n\n",
      sep = ""
    )
    
    tab5 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = spolic) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab6 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = spolic) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab5_6 = rbind(tab5, tab6)
    
    wykres3 = ggplot(tab5_6, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu technikum\nkontynuowali naukę w szkole policealnej"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab5_6$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres3)
    
    # wykres Kwalifikacyjne Kursy Zawodowe
    cat(
      "Kwalifikacyjne kursy zawodowe okazały się formą kontynuowania nauki przez ",
      round(szkola$kontyn_eduk_2f[[1]]$kkz * 100),
      "% absolwentów Państwa szkoły, którzy wypełnili ankiety.\n\n",
      sep = ""
    )
    
    tab7 = as.data.frame(szkola$kontyn_eduk_2f[[1]]) %>% 
      select(rozklad = kkz) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Państwa szkoła")
    
    tab8 = as.data.frame(wojSzk$kontyn_eduk_2f_waga[[1]]) %>% 
      select(rozklad = kkz) %>% 
      mutate(lab = paste0(round(rozklad * 100), "%"),
             typ = "Pozostałe szkoły\nz województwa")
    
    tab7_8 = rbind(tab7, tab8)
    
    wykres4 = ggplot(tab7_8, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
      geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
      scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
      labs(fill = NULL,
           title = paste0(
             "Wykres ", wyk_num(),
             ": Odsetek absolwentów, którzy po ukończeniu technikum\nkontynuowali naukę na Kwalifikacyjnym Kursie Zawodowym"
           )) +
      geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab7_8$rozklad, 2) < 0.05, -1.3, 0.5)) +
      ylab(NULL) +
      xlab(NULL) +
      coord_flip() +
      theme(legend.position = "none",
            panel.background = element_rect(fill = "white"),
            axis.ticks.y = element_blank(),
            axis.ticks.x = element_blank(),
            plot.title.position = "plot",
            plot.title = element_text(size = 12)) +
      geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
    print(wykres4)
  } else {
    cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
  }
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

# 3. Praca zawodowa

W momencie wypełniania ankiety pracowało zarobkowo `r round(szkola$praca_zarob_2f[[1]]$ods_zarobki * 100)`% absolwentów Państwa szkoły.

\textcolor{gray}{W pytaniu uwzględniono pracę na etacie, ale także prace dorywcze, na własny rachunek, w indywidualnym gospodarstwie rolnym i wszelkie inne, w tym także prace bez pisemnej umowy.}

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$praca_zarob_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$praca_zarob_2f[[1]]) %>% 
    select(rozklad = ods_zarobki) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = as.data.frame(wojSzk$praca_zarob_2f_waga[[1]]) %>% 
    select(rozklad = ods_zarobki) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów pracujących zarobkowo w momencie\nrealizacji badania"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

\textcolor{gray}{\relscale{0.75}Wykres przedstawia odpowiedzi `r szkola$praca_zarob_2f[[1]]$n` absolwentów Państwa szkoły oraz `r round(wojSzk$praca_zarob_2f_waga[[1]]$n)` absolwentów innych `r szkola$formy_2f[[1]]$szkola_lmn` z województwa `r szkola$formy_2f[[1]]$woj_nazwa_dop`. Respondentom zadano pytanie "Czy obecnie pracuje Pan(i) zarobkowo? Chodzi tu nie tylko o pracę na etacie, ale także o prace dorywcze, na własny rachunek, w indywidualnym gospodarstwie rolnym i wszelkie inne, w tym także prace bez pisemnej umowy." Respondenci wskazywali odpowiedź "Tak" lub "Nie".}

## 3.1. Zgodność pracy z wykształceniem

Wykonywanie pracy przez co najmniej dwa tygodnie w okresie od lipca 2020 roku do momentu wypełnienia ankiety, w zawodzie, którego uczyli się w Państwa szkole, zadeklarowało `r round(szkola$praca_zarob_zawod_2f[[1]]$ods_zarobki_zawod * 100)`% jej absolwentów.

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$praca_zarob_zawod_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$praca_zarob_zawod_2f[[1]]) %>% 
    select(rozklad = ods_zarobki_zawod) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = as.data.frame(wojSzk$praca_zarob_zawod_2f_waga[[1]]) %>% 
    select(rozklad = ods_zarobki_zawod) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów, którzy podjęli pracę zarobkową\nw wyuczonym zawodzie"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

\textcolor{gray}{\relscale{0.75}Wykres przedstawia odpowiedzi `r szkola$praca_zarob_zawod_2f[[1]]$n` absolwentów Państwa szkoły oraz `r round(wojSzk$praca_zarob_zawod_2f_waga[[1]]$n)` absolwentów innych `r szkola$formy_2f[[1]]$szkola_lmn` z województwa `r szkola$formy_2f[[1]]$woj_nazwa_dop`. Respondentom zadano pytanie "Czy w okresie od lipca do [miesiąc poprzedzający miesiąc, w którym respondent wypełnia ankietę] 2020 roku w sumie przez co najmniej dwa tygodnie wykonywał(a) Pan(i) pracę zarobkową w: zawodzie [zawód, w którym kształcił się respondent]? (...)". Respondenci wskazywali odpowiedź "Tak" lub "Nie".}

Natomiast `r round(szkola$praca_zarob_branza_2f[[1]]$ods_zarobki_branza * 100)`% stwierdziło, że w tym okresie wprawdzie nie pracowali w wyuczonym zawodzie, ale pracowali w branży, do której ten zawód należy.

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$praca_zarob_branza_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$praca_zarob_branza_2f[[1]]) %>% 
    select(rozklad = ods_zarobki_branza) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Państwa szkoła")
  
  tab2 = as.data.frame(wojSzk$praca_zarob_branza_2f_waga[[1]]) %>% 
    select(rozklad = ods_zarobki_branza) %>% 
    mutate(lab = paste0(round(rozklad * 100), "%"),
           typ = "Pozostałe szkoły\nz województwa")
  
  tab = rbind(tab1, tab2)
  
  ggplot(tab, aes(x = reorder(typ, desc(typ)), y = rozklad)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white", fill = "#f768a1") +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Odsetek absolwentów, którzy podjęli pracę zarobkową w zawodzie\ninnym niż wyuczony, ale należącym do tej samej branży"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3, hjust = ifelse(round(tab$rozklad, 2) < 0.05, -1.3, 0.5)) +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "none",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12)) +
    geom_rect(xmin = 0.5, xmax = 2.5, ymin = 0, ymax = 1, colour = "black", alpha = 0, size = 0.25)
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

\textcolor{gray}{\relscale{0.75}Wykres przedstawia odpowiedzi `r szkola$praca_zarob_branza_2f[[1]]$n` absolwentów Państwa szkoły oraz `r round(wojSzk$praca_zarob_branza_2f_waga[[1]]$n)` absolwentów innych `r szkola$formy_2f[[1]]$szkola_lmn` z województwa `r szkola$formy_2f[[1]]$woj_nazwa_dop`. Respondentom zadano pytanie "Czy w okresie od lipca do [miesiąc poprzedzający miesiąc, w którym respondent wypełnia ankietę] 2020 roku w sumie przez co najmniej dwa tygodnie wykonywał(a) Pan(i) pracę zarobkową w: zawodzie [zawód, w którym kształcił się respondent]?; innym zawodzie, ale w branży [branża, w której kształcił się respondent]. Respondenci wskazywali odpowiedź "Tak" lub "Nie". Na wykresie uwzględniono respondentów, którzy odpowiedzieli przecząco na pytanie dotyczące zawodu ale twierdząco na pytanie dotyczące branży.}

## 3.2. Zadowolenie z pracy

### 3.2.1. Ogólne zadowolenie z pracy

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_ogolnie_2f[[1]]$n >= progLiczebnosci) {
  
  zadowolenie = case_when(szkola$praca_zad_ogolnie_2f[[1]]$zad_zdecyd_raczej > szkola$praca_zad_ogolnie_2f[[1]]$nzad_zdecyd_raczej ~ "mniej",
                          szkola$praca_zad_ogolnie_2f[[1]]$nzad_zdecyd_raczej > szkola$praca_zad_ogolnie_2f[[1]]$zad_zdecyd_raczej ~ "więcej"
  )
  
  cat(
    "Spośród absolwentów Państwa szkoły pracujących zarobkowo w momencie udziału w badaniu, ",
    round(szkola$praca_zad_ogolnie_2f[[1]]$zad_zdecyd_raczej * 100),
    "% wyraziło ogólne zadowolenie ze swojej aktualnej pracy. Niezadowolonych było ",
    zadowolenie,
    ": ",
    round(szkola$praca_zad_ogolnie_2f[[1]]$nzad_zdecyd_raczej * 100),
    "%",
    sep = ""
  )
  
  if ((round(szkola$praca_zad_ogolnie_2f[[1]]$ani_zad_ani_nzad * 100) + round(szkola$praca_zad_ogolnie_2f[[1]]$trudno_pow * 100)) > 0) {
    cat(
      ". Pozostali wybrali odpowiedź pośrednią (",
      round(szkola$praca_zad_ogolnie_2f[[1]]$ani_zad_ani_nzad * 100),
      "%) lub nie byli w stanie ocenić, na ile są zadowoleni (",
      round(szkola$praca_zad_ogolnie_2f[[1]]$trudno_pow * 100),
      "%).\n\n",
      sep = ""
    )
  } else {
    cat(".\n\n")
  }
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_ogolnie_2f[[1]]$n >= progLiczebnosci) {
  tab1 = as.data.frame(szkola$praca_zad_ogolnie_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  tab2 = as.data.frame(wojSzk$praca_zad_ogolnie_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  
  tab = rbind(tab1, tab2)
  tab$name = factor(tab$name, levels = c("Zadowoleni",
                                         "Ani zadowoleni\nani niezadowoleni",
                                         "Niezadowoleni",
                                         "Trudno powiedzieć"))
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = reorder(name, desc(name)))) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#808080", "#fa9fb5", "#c51b8a", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące ogólnego poziomu zadowolenia z\npodjętej pracy zarobkowej"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)

  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$praca_zad_ogolnie_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$praca_zad_ogolnie_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Na ile jest Pan(i) zadowolony(a) ze swojej obecnej pracy… ogólnie, biorąc wszystko pod uwagę. [Jeżeli pracuje Pan(i) w kilku miejscach, to proszę odnieść się do tej pracy, która zajmuje Panu(i) najwięcej czasu]”. Respondenci wskazywali odpowiedź: “Zdecydowanie zadowolony(a)”, “Raczej zadowolony(a)”, “Ani zadowolony(a) ani niezadowolony(a)”, “Ani zadowolony(a) ani niezadowolony(a)”, “Zdecydowanie niezadowolony(a)”, “Trudno powiedzieć”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

### 3.2.2. Możliwości rozwoju zawodowego

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_rozwoj_2f[[1]]$n >= progLiczebnosci) {
  cat(
    "Z możliwości rozwoju zawodowego, jakie daje aktualnie wykonywana praca, zadowolonych było ",
    round(szkola$praca_zad_rozwoj_2f[[1]]$zad_zdecyd_raczej * 100),
    "% spośród pracujących zarobkowo absolwentów Państwa szkoły. Z kolei niezadowolonych pod tym względem było ",
    round(szkola$praca_zad_rozwoj_2f[[1]]$nzad_zdecyd_raczej * 100),
    "%.\n\n",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_rozwoj_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$praca_zad_rozwoj_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  tab2 = as.data.frame(wojSzk$praca_zad_rozwoj_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  
  tab = rbind(tab1, tab2)
  tab$name = factor(tab$name, levels = c("Zadowoleni",
                                         "Ani zadowoleni\nani niezadowoleni",
                                         "Niezadowoleni",
                                         "Trudno powiedzieć"))
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = reorder(name, desc(name)))) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#808080", "#fa9fb5", "#c51b8a", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące poziomu zadowolenia z możliwości\nrozwoju zawodowego w podjętej pracy zarobkowej"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
  
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$praca_zad_rozwoj_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$praca_zad_rozwoj_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Na ile jest Pan(i) zadowolony(a) ze swojej obecnej pracy… pod względem możliwości rozwoju umiejętności zawodowych. [Jeżeli pracuje Pan(i) w kilku miejscach, to proszę odnieść się do tej pracy, która zajmuje Panu(i) najwięcej czasu]”. Respondenci wskazywali odpowiedź: “Zdecydowanie zadowolony(a)”, “Raczej zadowolony(a)”, “Ani zadowolony(a) ani niezadowolony(a)”, “Raczej niezadowolony(a)”, “Zdecydowanie niezadowolony(a)”, “Trudno powiedzieć”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
}
```

### 3.2.3. Możliwości godzenia pracy z życiem poza pracą

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_zycie_2f[[1]]$n >= progLiczebnosci) {
  cat(
    "Pod względem możliwości godzenia wykonywanej pracy z \"życiem poza pracą\" usatysfakcjonowanych było ",
    round(szkola$praca_zad_zycie_2f[[1]]$zad_zdecyd_raczej * 100),
    "% spośród absolwentów Państwa szkoły, którzy w momencie udziału w badaniu pracowali zarobkowo. Przeciwną opinię wyraziło ",
    round(szkola$praca_zad_zycie_2f[[1]]$nzad_zdecyd_raczej * 100),
    "%.\n\n",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_zycie_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$praca_zad_zycie_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  tab2 = as.data.frame(wojSzk$praca_zad_zycie_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  
  tab = rbind(tab1, tab2)
  tab$name = factor(tab$name, levels = c("Zadowoleni",
                                         "Ani zadowoleni\nani niezadowoleni",
                                         "Niezadowoleni",
                                         "Trudno powiedzieć"))
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = reorder(name, desc(name)))) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#808080", "#fa9fb5", "#c51b8a", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące poziomu zadowolenia z możliwości\ngodzenia pracy zarobkowej z życiem poza pracą"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
 
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$praca_zad_zycie_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$praca_zad_zycie_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Na ile jest Pan(i) zadowolony(a) ze swojej obecnej pracy… pod względem możliwości godzenia pracy z życiem poza pracą. [Jeżeli pracuje Pan(i) w kilku miejscach, to proszę odnieść się do tej pracy, która zajmuje Panu(i) najwięcej czasu]”. Respondenci wskazywali odpowiedź: “Zdecydowanie zadowolony(a)”, “Raczej zadowolony(a)”, “Ani zadowolony(a) ani niezadowolony(a)”, “Raczej niezadowolony(a)”, “Zdecydowanie niezadowolony(a)”, “Trudno powiedzieć”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
}
```

### 3.2.4. Satysfakcja z poziomu zarobków

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_zarobki_2f[[1]]$n >= progLiczebnosci) {
  cat(
    "Zarobkami usatysfakcjonowanych było ",
    round(szkola$praca_zad_zarobki_2f[[1]]$zad_zdecyd_raczej * 100),
    "% spośród absolwentów Państwa szkoły pracujących w momencie badania. Niezadowolenie z wysokości zarobków wyraziło ",
    round(szkola$praca_zad_zarobki_2f[[1]]$nzad_zdecyd_raczej * 100),
    "%.\n\n",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_zarobki_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$praca_zad_zarobki_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  tab2 = as.data.frame(wojSzk$praca_zad_zarobki_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  
  tab = rbind(tab1, tab2)
  tab$name = factor(tab$name, levels = c("Zadowoleni",
                                         "Ani zadowoleni\nani niezadowoleni",
                                         "Niezadowoleni",
                                         "Trudno powiedzieć"))
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = reorder(name, desc(name)))) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#808080", "#fa9fb5", "#c51b8a", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące poziomu satysfakcji z\nuzyskiwanych zarobków"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
 
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$praca_zad_zarobki_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$praca_zad_zarobki_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Na ile jest Pan(i) zadowolony(a) ze swojej obecnej pracy… pod względem wysokości zarobków. [Jeżeli pracuje Pan(i) w kilku miejscach, to proszę odnieść się do tej pracy, która zajmuje Panu(i) najwięcej czasu]”. Respondenci wskazywali odpowiedź:  “Zdecydowanie zadowolony(a)”, “Raczej zadowolony(a)”, “Ani zadowolony(a) ani niezadowolony(a)”, “Raczej niezadowolony(a)”, “Zdecydowanie niezadowolony(a)”, “Trudno powiedzieć”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
}
```

### 3.2.5. Pewność utrzymania pracy

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_pewnosc_2f[[1]]$n >= progLiczebnosci) {
  cat(
    "Pewność utrzymania pracy pozytywnie oceniło ",
    round(szkola$praca_zad_pewnosc_2f[[1]]$zad_zdecyd_raczej * 100),
    "% spośród pracujących absolwentów Państwa szkoły. Niezadowolenie z aktualnie wykonywanej pracy pod względem stopnia pewności, że uda się ją utrzymać, wyraziło ",
    round(szkola$praca_zad_pewnosc_2f[[1]]$nzad_zdecyd_raczej * 100),
    "%.\n\n",
    sep = ""
  )
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$praca_zad_pewnosc_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$praca_zad_pewnosc_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  tab2 = as.data.frame(wojSzk$praca_zad_pewnosc_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Zadowoleni",
                    "Ani zadowoleni\nani niezadowoleni",
                    "Niezadowoleni",
                    "Trudno powiedzieć"))
  
  tab = rbind(tab1, tab2)
  tab$name = factor(tab$name, levels = c("Zadowoleni",
                                         "Ani zadowoleni\nani niezadowoleni",
                                         "Niezadowoleni",
                                         "Trudno powiedzieć"))
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = reorder(name, desc(name)))) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#808080", "#fa9fb5", "#c51b8a", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące poziomu zadowolenia ze stabilności\npracy zarobkowej"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
 
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$praca_zad_pewnosc_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$praca_zad_pewnosc_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Na ile jest Pan(i) zadowolony(a) ze swojej obecnej pracy… pod względem pewności, że ją Pan(i) utrzyma. [Jeżeli pracuje Pan(i) w kilku miejscach, to proszę odnieść się do tej pracy, która zajmuje Panu(i) najwięcej czasu]”. Respondenci wskazywali odpowiedź:  “Zdecydowanie zadowolony(a)”, “Raczej zadowolony(a)”, “Ani zadowolony(a) ani niezadowolony(a)”, “Raczej niezadowolony(a)”, “Zdecydowanie niezadowolony(a)”, “Trudno powiedzieć”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")`

# 4. Nauka zdalna podczas pandemii

Absolwentom z rocznika 2019/2020, ze względu na szczególny okres, na jaki przypadała ich nauka w ostatnich klasach, zostały zadane również pytania dotyczące udziału w nauce zdalnej.

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}

szk_forma = case_when(
  szkola$TYP %in% 1 ~ "szkołach branżowych pierwszego stopnia",
  szkola$TYP %in% 2 ~ "technikach",
  szkola$TYP %in% 3 ~ "szkołach policealnych")

cat(
  "\n\nOd 25 marca 2020 roku, ze względu na pandemię, nauka w ",
  szk_forma,
  " realizowana była przeważnie za pomocą metod i technik kształcenia na odległość.\n\n",
  sep = ""
)
```

## 4.1. Czas poświęcany na naukę

Z odpowiedzi absolwentów Państwa szkoły wynika, że nauka zdalna sprawiła, że `r round(szkola$czas_przed_ogolne_2f[[1]]$mniej * 100)`% poświęcało w ostatniej klasie mniej czasu na naukę **przedmiotów ogólnych**. Zdalna forma nauki miała odwrotny efekt w przypadku `r round(szkola$czas_przed_ogolne_2f[[1]]$wiecej * 100)`% absolwentów Państwa szkoły, natomiast w przypadku `r round(szkola$czas_przed_ogolne_2f[[1]]$tyle_samo * 100)`% nie wpłynęła na czas poświęcany na naukę przedmiotów ogólnych.

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$czas_przed_ogolne_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$czas_przed_ogolne_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Mniej",
                    "Tyle samo",
                    "Więcej",
                    "Trudno powiedzieć"))
  tab2 = as.data.frame(wojSzk$czas_przed_ogolne_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Mniej",
                    "Tyle samo",
                    "Więcej",
                    "Trudno powiedzieć"))
  
  tab = rbind(tab1, tab2)
  tab$name = factor(tab$name, levels = c("Mniej",
                                         "Tyle samo",
                                         "Więcej",
                                         "Trudno powiedzieć"))
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = reorder(name, desc(name)))) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#808080", "#fa9fb5", "#c51b8a", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące czasu poświęcanego na naukę\nprzedmiotów ogólnych w okresie pandemii"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
      
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$czas_przed_ogolne_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$czas_przed_ogolne_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Jak to, że nauka w okresie pandemii odbywała się zdalnie, wpłynęło na czas poświęcany przez Panią/Pana na: naukę przedmiotów ogólnych? (...)”. Respondenci wskazywali odpowiedź “poświęcałem(am) mniej czasu”, “poświęcałem(am) tyle samo czasu, ”poświęcałem(am) więcej czasu” lub “trudno powiedzieć”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

Pozytywny wpływ nauki zdalnej na czas poświęcany w ostatniej klasie przez absolwentów Państwa szkoły na opanowanie **teorii przedmiotów zawodowych** odnotowano w przypadku `r round(szkola$czas_przedzaw_teo_2f[[1]]$wiecej * 100)`%. W przypadku `r round(szkola$czas_przedzaw_teo_2f[[1]]$mniej * 100)`% nauka w tej formie zmniejszyła czas, jaki poświęcali na teoretyczne przedmioty zawodowe, a w przypadku `r round(szkola$czas_przedzaw_teo_2f[[1]]$tyle_samo * 100)`% nie miała wpływu.

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$czas_przedzaw_teo_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$czas_przedzaw_teo_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Mniej",
                    "Tyle samo",
                    "Więcej",
                    "Trudno powiedzieć"))
  tab2 = as.data.frame(wojSzk$czas_przedzaw_teo_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Mniej",
                    "Tyle samo",
                    "Więcej",
                    "Trudno powiedzieć"))
  
  tab = rbind(tab1, tab2)
  tab$name = factor(tab$name, levels = c("Mniej",
                                         "Tyle samo",
                                         "Więcej",
                                         "Trudno powiedzieć"))
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = reorder(name, desc(name)))) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#808080", "#fa9fb5", "#c51b8a", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące czasu poświęcanego na teoretyczną\nnaukę przedmiotów zawodowych w okresie pandemii"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
      
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$czas_przedzaw_teo_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$czas_przedzaw_teo_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Jak to, że nauka w okresie pandemii odbywała się zdalnie, wpłynęło na czas poświęcany przez Panią/Pana na: (...) teoretyczną naukę przedmiotów zawodowych? (...)”. Respondenci wskazywali odpowiedź “poświęcałem(am) mniej czasu”, “poświęcałem(am) tyle samo czasu, ”poświęcałem(am) więcej czasu” lub “trudno powiedzieć”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

Odbywanie nauki zdalnie skróciło czas poświęcony w ostatniej klasie na **praktyczną naukę zawodu** przez `r round(szkola$czas_przedzaw_prak_2f[[1]]$mniej * 100)`% absolwentów Państwa szkoły, a wydłużyło w przypadku `r round(szkola$czas_przedzaw_prak_2f[[1]]$wiecej * 100)`%. Absolwenci, którzy w warunkach nauki zdalnej poświęcili na praktyczną naukę zawodu tyle samo czasu, co gdyby nauka szkolna odbywała się stacjonarnie, stanowili `r round(szkola$czas_przedzaw_prak_2f[[1]]$tyle_samo * 100)`%.

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$czas_przedzaw_prak_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$czas_przedzaw_prak_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Mniej",
                    "Tyle samo",
                    "Więcej",
                    "Trudno powiedzieć"))
  tab2 = as.data.frame(wojSzk$czas_przedzaw_prak_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Mniej",
                    "Tyle samo",
                    "Więcej",
                    "Trudno powiedzieć"))
  
  tab = rbind(tab1, tab2)
  tab$name = factor(tab$name, levels = c("Mniej",
                                         "Tyle samo",
                                         "Więcej",
                                         "Trudno powiedzieć"))
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = reorder(name, desc(name)))) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#808080", "#fa9fb5", "#c51b8a", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące czasu poświęcanego na praktyczną\nnaukę przedmiotów zawodowych w okresie pandemii"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
      
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$czas_przedzaw_prak_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$czas_przedzaw_prak_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Jak to, że nauka w okresie pandemii odbywała się zdalnie, wpłynęło na czas poświęcany przez Panią/Pana na: (...) praktyczną naukę przedmiotów zawodowych?”. Respondenci wskazywali odpowiedź “poświęcałem(am) mniej czasu”, “poświęcałem(am) tyle samo czasu, ”poświęcałem(am) więcej czasu” lub “trudno powiedzieć”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

## 4.2. Warunki do nauki zdalnej

### 4.2.1. Połączenie z internetem

W stosunku do potrzeb związanych z nauką zdalną w ostatniej klasie, wystarczająco dobre połączenie z internetem miało `r round(szkola$war_internet_2f[[1]]$wyst * 100)`% absolwentów Państwa szkoły, którzy wzięli udział w badaniu. Niewystarczający dostęp do takiego łącza miało `r round(szkola$war_internet_2f[[1]]$n_wyst * 100)`%.
```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$war_internet_2f[[1]]$n >= progLiczebnosci) {
  if (round(szkola$war_internet_2f[[1]]$niepotrz * 100) %in% 0) {
    cat("")
  } else {
    cat(
      " Natomiast ",
      round(szkola$war_internet_2f[[1]]$niepotrz * 100),
      "% oceniło, że dobre połączenie z internetem nie było im do nauki zdalnej potrzebne.",
      sep = ""
    )
  }
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$war_internet_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$war_internet_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Niewystarczające",
                    "Wystarczające",
                    "Niepotrzebne"))
  tab2 = as.data.frame(wojSzk$war_internet_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Niewystarczające",
                    "Wystarczające",
                    "Niepotrzebne"))
  # tab1$name = factor(tab1$name, levels = c("Wystarczające",
  #                                          "Niewystarczające","Niepotrzebne"))
  # tab2$name = factor(tab2$name, levels = c("Wystarczające",
  #                                          "Niewystarczające",
  #                                          "Niepotrzebne"))
  
  tab = rbind(tab1, tab2)
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#f44b8f", "#b20174", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące warunków do nauki\nzdalnej - połączenie z internetem"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
      
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$war_internet_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$war_internet_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Nauka zdalna w okresie epidemii wymagała odpowiednich warunków. Jakie miał(a) Pan(i) wtedy możliwości korzystania z: dobrego połączenia z internetem? (...). Respondenci wskazywali odpowiedź “całkowicie wystarczające do nauki zdalnej”, “raczej wystarczające do nauki zdalnej”, “raczej niewystarczające do nauki zdalnej”, “w ogóle niewystarczające do nauki zdalnej”, “to nie było potrzebne do nauki zdalnej”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    arrange(desc(name)) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

### 4.2.2. Sprzęt komputerowy

Pod względem możliwości korzystania z komputera, laptopa lub tabletu, warunki sprzyjające nauce zdalnej miało w ostatniej klasie `r round(szkola$war_komp_2f[[1]]$wyst * 100)`% absolwentów Państwa szkoły, którzy wypełnili ankiety. Deficyty w zakresie sprzętu komputerowego utrudniające udział w nauce zdalnej wystąpiły w przypadku `r round(szkola$war_komp_2f[[1]]$n_wyst * 100)`%.
```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$war_komp_2f[[1]]$n >= progLiczebnosci) {
  if (round(szkola$war_komp_2f[[1]]$niepotrz * 100) %in% 0) {
    cat("")
  } else {
    cat(
      " Tego rodzaju wyposażenie nie było potrzebne do nauki zdalnej zdaniem ",
      round(szkola$war_komp_2f[[1]]$niepotrz * 100),
      "%.",
      sep = ""
    )
  }
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$war_komp_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$war_komp_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Niewystarczające",
                    "Wystarczające",
                    "Niepotrzebne"))
  tab2 = as.data.frame(wojSzk$war_komp_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Niewystarczające",
                    "Wystarczające",
                    "Niepotrzebne"))
  # tab1$name = factor(tab1$name, levels = c("Wystarczające",
  #                                         "Niewystarczające",
  #                                         "Niepotrzebne"))
  # tab2$name = factor(tab2$name, levels = c("Wystarczające",
  #                                         "Niewystarczające",
  #                                         "Niepotrzebne"))
  
  tab = rbind(tab1, tab2)
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#f44b8f", "#b20174", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące warunków do nauki\nzdalnej - sprzęt komputerowy"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
      
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$war_komp_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$war_komp_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Nauka zdalna w okresie epidemii wymagała odpowiednich warunków. Jakie miał(a) Pan(i) wtedy możliwości korzystania z: (...) odpowiedniego komputera, laptopa lub tabletu? (...)”. Respondenci wskazywali odpowiedź “całkowicie wystarczające do nauki zdalnej”, “raczej wystarczające do nauki zdalnej”, “raczej niewystarczające do nauki zdalnej”, “w ogóle niewystarczające do nauki zdalnej”, “to nie było potrzebne do nauki zdalnej”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    arrange(desc(name)) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

### 4.2.3. Miejsce do nauki

Wystarczające możliwości nauki zdalnej w spokojnym miejscu miało w ostatniej klasie `r round(szkola$war_miejsce_2f[[1]]$wyst * 100)`% absolwentów Państwa szkoły objętych badaniem. W sytuacji niesprzyjającej pod tym względem nauce zdalnej było `r round(szkola$war_miejsce_2f[[1]]$n_wyst * 100)`%
```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$war_miejsce_2f[[1]]$n >= progLiczebnosci) {
  if (round(szkola$war_miejsce_2f[[1]]$niepotrz * 100) %in% 0) {
    cat(".")
  } else {
    cat(
      ", a ",
      round(szkola$war_miejsce_2f[[1]]$niepotrz * 100),
      "% uznało, że spokojne miejsce do nauki zdalnej nie było im potrzebne.",
      sep = ""
    )
  }
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$war_miejsce_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$war_miejsce_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Niewystarczające",
                    "Wystarczające",
                    "Niepotrzebne"))
  tab2 = as.data.frame(wojSzk$war_miejsce_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Niewystarczające",
                    "Wystarczające",
                    "Niepotrzebne"))
  # tab1$name = factor(tab1$name, levels = c("Wystarczające",
  #                                         "Niewystarczające",
  #                                         "Niepotrzebne"))
  # tab2$name = factor(tab2$name, levels = c("Wystarczające",
  #                                         "Niewystarczające",
  #                                         "Niepotrzebne"))
  
  tab = rbind(tab1, tab2)
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#f44b8f", "#b20174", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące warunków do nauki\nzdalnej - miejsce do nauki"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
      
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$war_miejsce_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$war_miejsce_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Nauka zdalna w okresie epidemii wymagała odpowiednich warunków. Jakie miał(a) Pan(i) wtedy możliwości korzystania z: (...) spokojnego miejsca do nauki? (...)”. Respondenci wskazywali odpowiedź “całkowicie wystarczające do nauki zdalnej”, “raczej wystarczające do nauki zdalnej”, “raczej niewystarczające do nauki zdalnej”, “w ogóle niewystarczające do nauki zdalnej”, “to nie było potrzebne do nauki zdalnej”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    arrange(desc(name)) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

### 4.2.4. Pomoc w przypadku trudności

Z wystarczającej pomocy w nauce, w przypadku napotkania trudności gdy odbywała się zdalnie, mogło korzystać w ostatniej klasie `r round(szkola$war_pomoc_2f[[1]]$wyst * 100)`% absolwentów Państwa szkoły uczestniczących w badaniu. Potrzeby w tym zakresie `r round(szkola$war_pomoc_2f[[1]]$n_wyst * 100)`% respondentów nie były zaspokojone.
```{r, echo = FALSE, message = FALSE, results = 'asis', fig.align = wyrownanieTabWykr}
if (szkola$war_pomoc_2f[[1]]$n >= progLiczebnosci) {
  if (round(szkola$war_pomoc_2f[[1]]$niepotrz * 100) %in% 0) {
    cat("")
  } else {
    cat(
      " Pomoc w przypadku trudności w nauce nie była potrzebna podczas nauki zdalnej ",
      round(szkola$war_pomoc_2f[[1]]$niepotrz * 100),
      "% absolwentów Państwa szkoły.",
      sep = ""
    )
  }
}
```

```{r, echo = FALSE, message = FALSE, results = 'asis', fig.height = 2.5, fig.align = wyrownanieTabWykr}
if (szkola$war_pomoc_2f[[1]]$n >= progLiczebnosci) {
  
  tab1 = as.data.frame(szkola$war_pomoc_2f[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Państwa szkoła",
           name = c("Niewystarczające",
                    "Wystarczające",
                    "Niepotrzebne"))
  tab2 = as.data.frame(wojSzk$war_pomoc_2f_waga[[1]]) %>% 
    select(-c(n, etykieta)) %>% 
    pivot_longer(everything()) %>% 
    mutate(lab = case_when(round(value, 2) >= 0.06 ~ paste0(round(value * 100), "%"),
                           round(value, 2) < 0.06 ~ ""),
           typ = "Pozostałe szkoły\nz województwa",
           name = c("Niewystarczające",
                    "Wystarczające",
                    "Niepotrzebne"))
  # tab1$name = factor(tab1$name, levels = c("Wystarczające",
  #                                         "Niewystarczające",
  #                                         "Niepotrzebne"))
  # tab2$name = factor(tab2$name, levels = c("Wystarczające",
  #                                         "Niewystarczające",
  #                                         "Niepotrzebne"))
  
  tab = rbind(tab1, tab2)
  
  wykres = ggplot(tab, aes(x = reorder(typ, desc(typ)), y = value, fill = name)) +
    geom_bar(width = 0.75, stat = "identity", colour = "white") +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = c("#f44b8f", "#b20174", "#5e015c"), guide = guide_legend(reverse = TRUE)) +
    labs(fill = NULL,
         title = paste0(
           "Wykres ", wyk_num(),
           ": Opinie absolwentów dotyczące warunków do nauki\nzdalnej - pomoc  w przypadku trudności"
         )) +
    geom_text(aes(label = lab), position = position_stack(vjust = 0.5), size = 3,
            colour = "#ffffff") +
    ylab(NULL) +
    xlab(NULL) +
    coord_flip() +
    theme(legend.position = "right",
          panel.background = element_rect(fill = "white"),
          axis.ticks.y = element_blank(),
          axis.ticks.x = element_blank(),
          plot.title.position = "plot",
          plot.title = element_text(size = 12))
  print(wykres)
      
  cat(
    "\\textcolor{gray}{\\relscale{0.75}Wykres przedstawia odpowiedzi ",
    szkola$war_pomoc_2f[[1]]$n,
    " absolwentów Państwa szkoły oraz ",
    round(wojSzk$war_pomoc_2f_waga[[1]]$n),
    " absolwentów innych ",
    szkola$formy_2f[[1]]$szkola_lmn,
    " z województwa ",
    szkola$formy_2f[[1]]$woj_nazwa_dop,
    ". Respondentom zadano pytanie “Nauka zdalna w okresie epidemii wymagała odpowiednich warunków. Jakie miał(a) Pan(i) wtedy możliwości korzystania z: (...) czyjejś pomocy w nauce w przypadku trudności”. Respondenci wskazywali odpowiedź “całkowicie wystarczające do nauki zdalnej”, “raczej wystarczające do nauki zdalnej”, “raczej niewystarczające do nauki zdalnej”, “w ogóle niewystarczające do nauki zdalnej”, “to nie było potrzebne do nauki zdalnej”.}\n\nDane z wykresu przedstawiono szczegółowo w poniższej tabeli.",
    sep = "")
  
  tab1 %>% 
    left_join(tab2, by = "name") %>% 
    select(-contains(c("typ", "lab"))) %>% 
    mutate(xx = paste0(round(value.x * 100), "%"),
           yy = paste0(round(value.y * 100), "%")) %>% 
    select(-contains("value")) %>% 
    arrange(desc(name)) %>% 
    kable("latex", booktabs = TRUE,
          col.names = NULL, linesep = "",
          align = "lcc") %>%
    kable_styling(position = wyrownanieTabWykr,
                  latex_options = "hold_position") %>% 
    add_header_above(c(" ", "Państwa szkoła" = 1, "Pozostałe szkoły z województwa" = 1))
} else {
  cat("Odpowiedzi uzyskano od mniej niż 10 absolwentów Państwa szkoły - grupa ta jest zbyt mało liczna, żeby przedstawić wyniki.")
}
```

`r ifelse(typDokumentu %in% "pdf", "\\newpage", "")` 

`r ifelse(typDokumentu %in% "pdf", "---", "")`

Więcej informacji o monitorowaniu losów absolwentów znajdą Państwo na stronie:

<https://losyabsolwentow.ibe.edu.pl/>
